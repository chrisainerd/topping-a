물론입니다. 제공해주신 이미지와 요구사항을 바탕으로, 기존 시스템을 효율적으로 활용하여 **"옷장 맞춤 선반 추가 CPQ 모델"**을 개발하기 위한 상세한 제품 요구사항 명세서(PRD)를 작성해 드리겠습니다.

---

### **PRD: 옷장 맞춤 선반 추가 CPQ(Configure, Price, Quote) 모델**

#### 1. 문서 정보
*   **프로젝트명:** 옷장 맞춤 선반 추가 기능 개발
*   **작성자:** (담당자 이름)
*   **작성일:** 2023-10-27
*   **버전:** 1.0

#### 2. 개요 (Overview)
본 프로젝트는 기존 가구 CPQ 솔루션에 **사용자가 소유한 옷장 내부에 원하는 크기와 수량의 선반을 시각적으로 구성하고 실시간으로 견적을 받아 구매까지 연결**할 수 있는 새로운 모듈을 개발하는 것을 목표로 합니다. 사용자는 복잡한 계산 없이 자신의 옷장에 꼭 맞는 선반을 손쉽게 설계하고 주문할 수 있게 됩니다.

#### 3. 문제 정의 (Problem Statement)
*   사용자들은 기성품 옷장의 내부 구성에 만족하지 못하거나, 공간 활용도를 높이기 위해 선반 추가를 원합니다.
*   하지만 옷장의 내부 규격(가로, 깊이)이 제각각이라 딱 맞는 선반을 찾기 어렵고, 직접 측정하고 주문하는 과정이 번거롭습니다.
*   선반의 개수나 색상을 바꿀 때마다 가격이 어떻게 변하는지 즉각적으로 알기 어려워 구매 결정을 망설이게 됩니다.

#### 4. 목표 및 성공 지표
*   **목표:**
    1.  사용자가 1분 안에 자신의 옷장에 맞는 선반 구성을 완료하고 견적을 확인할 수 있도록 한다.
    2.  맞춤 선반 판매를 통한 새로운 수익원을 창출한다.
    3.  '누구나 쉽게 맞춤 가구를 설계할 수 있다'는 브랜드 경험을 강화한다.
*   **성공 지표:**
    *   **Conversion Rate:** 컨피규레이터 이용자 중 견적서(PDF) 다운로드 또는 구매 전환율 5% 달성
    *   **Engagement:** 평균 세션 시간 2분 이상 유지
    *   **CS 감소:** 선반 규격 문의 관련 고객 서비스(CS) 문의 30% 감소

#### 5. 사용자 페르소나 (User Persona)
*   **이름:** 김수납 (32세, 직장인)
*   **성향:** DIY와 인테리어에 관심이 많음. 효율적인 공간 활용을 중요하게 생각함.
*   **Pain Point:** "드레스룸에 있는 옷장이 너무 커서 위쪽 공간이 다 죽어요. 선반 몇 개만 더 있으면 가방이나 니트를 정리하기 딱 좋을 텐데, 어디서 맞춰야 할지 막막해요."

#### 6. 기능 요구사항 (Functional Requirements)

| ID | 기능명 | 사용자 스토리 (As a user, I want to...) | 상세 설명 | 우선순위 |
| :--- | :--- | :--- | :--- | :--- |
| **FR-01** | **옷장 규격 입력** | 내 옷장의 **내부 가로, 외부 가로, 깊이**를 입력하여 선반이 설치될 공간을 정의하고 싶다. | - 슬라이더와 숫자 직접 입력 방식 모두 지원<br>- 단위는 mm<br>- '내부 가로'는 추가될 선반의 실제 가로 길이가 됨<br>- '외부 가로'는 3D 뷰에서 옷장 외형을 표현하는 데 사용 | **Must Have** |
| **FR-02** | **선반 수량 조절** | 추가하고 싶은 **선반의 개수**를 슬라이더로 조절하여 레이아웃을 실시간으로 확인하고 싶다. | - 최소 1개 ~ 최대 10개 설정 가능<br>- 선반 개수 변경 시, 옷장 내부 높이 내에서 선반들이 자동으로 균등 분할되어 배치됨 | **Must Have** |
| **FR-03** | **색상 및 재질 선택** | 선반의 **상판(패널) 색상**과 **엣지(마감) 색상**을 각각 선택하여 디자인을 조합하고 싶다. | - 제공된 이미지의 '팔레트' UI를 재사용<br>- 패널과 엣지를 조합한 프리셋 제공 및 개별 선택 기능 | **Must Have** |
| **FR-04** | **실시간 3D 시각화** | 내가 입력한 값에 따라 **옷장 내부에 선반이 추가되는 모습**을 3D로 즉시 확인하고 싶다. | - 옷장 모델은 반투명 또는 와이어프레임으로 처리하여 내부 선반이 잘 보이도록 함<br>- 모든 파라미터 변경 시 3D 뷰가 지연 없이 업데이트되어야 함 | **Must Have** |
| **FR-05**| **실시간 견적** | 옵션을 변경할 때마다 **총 금액**이 어떻게 변하는지 실시간으로 보고 싶다. | - 가격은 하단에 항상 고정 표시<br>- 가격 계산 로직: `(선반 면적 x 자재 단가 + 선반 둘레 x 엣지 단가) x 선반 수량` | **Must Have** |
| **FR-06**| **견적서 다운로드** | 최종 확정한 디자인과 가격이 포함된 **견적서(PDF)**를 다운로드하여 보관하거나 공유하고 싶다. | - 기존 PDF 다운로드 기능 재사용<br>- PDF에는 3D 뷰 캡처, 최종 규격, 선택 색상, 총 견적이 포함되어야 함 | **Should Have** |

---

#### 7. 기술 가이드: 기존 기능 수정 및 개발 방향

**핵심 전략: 절차적 생성(Procedural Generation)을 통한 모델링**
이 프로젝트는 여러 개의 GLB 파일을 조립하는 방식이 아닌, **사용자 입력값에 따라 Three.js의 `BoxGeometry`를 실시간으로 생성 및 변형**하는 방식이 훨씬 효율적입니다.

1.  **3D 모델링 전략**
    *   **옷장 (Host Model):**
        *   새로운 GLB 모델이 필요 없습니다. `BoxGeometry` 2개를 이용해 외부 상자와 내부 상자를 만듭니다.
        *   외부 상자(`옷장 외부 가로` 값 사용)의 Material은 `transparent: true`, `opacity: 0.2`로 설정하여 반투명한 '유령' 형태로 만듭니다.
        *   이렇게 하면 사용자는 컨텍스트를 이해하면서도 내부 선반에 집중할 수 있습니다.
    *   **선반 (Procedural Model):**
        *   사용자가 `추가할 선반 수`를 조절할 때마다 해당 개수만큼 `THREE.Mesh(new THREE.BoxGeometry(), material)` 인스턴스를 생성/삭제합니다.
        *   각 선반 `BoxGeometry`의 파라미터는 사용자 입력값과 직접 연결됩니다: `new THREE.BoxGeometry(내부_가로, 선반_두께, 선반_깊이)`
        *   선반의 Y축 위치는 `(옷장_내부_높이 / (선반_수 + 1)) * (i + 1)` 와 같은 균등 분할 로직으로 계산하여 배치합니다.

2.  **UI 재사용 및 수정 가이드 (제공된 이미지 기반)**
    *   **`설계 파라미터` 패널 재사용:**
        *   **`가로 (W)` / `세로 (H)` / `깊이 (D)` →** **`옷장 내부 가로`, `옷장 외부 가로`, `선반 깊이`**로 라벨과 기능을 변경합니다. `세로(H)`는 이 모델에서 불필요하므로 제거하거나, 선반이 배치될 '총 높이'를 지정하는 옵션으로 활용할 수 있습니다.
        *   **`판 두께` →** **`선반 두께`**로 라벨 변경. 기능은 그대로 재사용합니다. (e.g., 18mm, 24mm)
        *   **`선반 수 (행)` →** **`추가할 선반 수`**로 라벨 변경. 기능은 그대로 재사용합니다.
        *   **`칸 수 (열)` →** UI에서 **제거**합니다. 수직 파티션은 이번 스펙에 포함되지 않습니다.
        *   **`팔레트 (패널+엣지)` →** **완벽하게 재사용**합니다. 선택된 색상/재질 정보를 선반 Mesh의 Material에 실시간으로 적용하는 로직만 연결하면 됩니다.
        *   **`문 사용`, `서랍 사용` 등 →** UI에서 모두 **제거**합니다.

3.  **견적 로직 연동**
    *   기존의 가격 계산 엔진을 활용하되, 입력 변수를 위 요구사항에 맞게 단순화합니다.
    *   모든 파라미터(규격, 선반 수, 자재)가 변경될 때마다 가격 계산 함수를 호출하여 UI를 업데이트합니다.

#### 8. 릴리즈 제외 항목 (Out of Scope)
*   수직 칸막이(Divider) 추가 기능
*   L자형 등 비정형 옷장 지원
*   서랍, 문 등 선반 외 다른 액세서리 추가 기능
*   다양한 재질(원목, 유리 등) 지원 (초기 릴리즈는 PB/MDF 색상만 지원)